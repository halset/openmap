# **********************************************************************
# 
#    Use, duplication, or disclosure by the Government is subject to
# 	     restricted rights as set forth in the DFARS.
#  
# 			   BBN Technologies
# 			    A Division of
# 			   BBN Corporation
# 			  10 Moulton Street
# 			 Cambridge, MA 02138
# 			    (617) 873-3000
#  
# 	  Copyright 1998 by BBN Technologies, A Division of
# 		BBN Corporation, all rights reserved.
#  
# **********************************************************************
# 
# $Source: /cvs/distapps/openmap/Attic/Makefile.in,v $
# $RCSfile: Makefile.in,v $
# $Revision: 1.9 $
# $Date: 1998/11/12 02:37:21 $
# $Author: tmitchel $
# 
# **********************************************************************


TOP = @top_srcdir@

############
# includes #
############
include ${TOP}/openmap.mk


#####################
# variable settings #
#####################

Core.jar =	com/bbn/openmap/*.class \
		com/bbn/openmap/*.gif \
		com/bbn/openmap/event/*.class \
		com/bbn/openmap/gui/*.class \
		com/bbn/openmap/gui/*.gif \
		com/bbn/openmap/omGraphics/*.class \
		com/bbn/openmap/proj/*.class \
		com/bbn/openmap/util/*.class

Layer.jar =	com/bbn/openmap/layer/*.class \
		com/bbn/openmap/layer/dted/*.class \
		com/bbn/openmap/layer/nitf/*.class \
		com/bbn/openmap/layer/pluginLayer/*.class \
		com/bbn/openmap/layer/plotLayer/*.class \
		com/bbn/openmap/layer/rpf/*.class \
		com/bbn/openmap/layer/shape/*.class \
#		com/bbn/openmap/layer/terrain/*.class \
		com/bbn/openmap/layer/util/cacheHandler/*.class \
		com/bbn/openmap/layer/util/html/*.class \
		com/bbn/openmap/layer/util/http/*.class \
		com/bbn/openmap/layer/util/stateMachine/*.class \
		com/bbn/openmap/layer/vpf/*.class

App.jar = 	com/bbn/openmap/app/*.class


#########
# rules #
#########

default:	all

# java compile OpenMap code
om_core:
	cd com && $(MAKE) all
	chmod +x bin/openmap

jar::
	$(RM) lib/omcore.jar lib/openmap.jar

jar:: 	om_core lib/omcore.jar lib/openmap.jar

all:	om_core jar

clean distclean::
	cd com && $(MAKE) $@

distclean::
	$(RM) Makefile openmap.mk bin/openmap
	$(RM) config.cache config.log config.status

lib:
	${INSTALL.dir} $@

lib/openmap.jar: lib
	jar cf $@ ${Core.jar} ${Layer.jar} ${App.jar}

lib/omcore.jar: lib
	jar cf $@ ${Core.jar}

GNUmakefile:
	perl rename.pl gmakefile GNUmakefile

gmakefile:
	perl rename.pl GNUmakefile gmakefile

################
# installation #
################

${bindir}:
	${INSTALL.dir} $@

${libdir}:
	${INSTALL.dir} $@

${datadir}:
	${INSTALL.dir} $@

install::	${bindir} bin/openmap
	${INSTALL.bin} bin/openmap ${bindir}/openmap

install::	${libdir} lib/omcore.jar lib/openmap.jar
	${INSTALL.jar} lib/omcore.jar ${libdir}/omcore.jar
	${INSTALL.jar} lib/openmap.jar ${libdir}/openmap.jar

DATA_FILES =	openmap.properties \
		dcwpo-browse.shp \
		dcwpo-browse.ssx

SHARE_DATA = ${DATA_FILES:%=share/%}

install::	${datadir}
	${INSTALL.data} ${SHARE_DATA} ${datadir}
